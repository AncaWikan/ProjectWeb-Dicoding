/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const t={parseActiveUrlWithCombiner:function(){var t=window.location.hash.slice(1).toLowerCase()||"/",e=this.urlSplitter(t);return this.urlCombiner(e)},urlSplitter:function(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null,verb:e[3]||null}},urlCombiner:function(t){return"/".concat(t.resource||"").concat(t.id?"/:id":"").concat(t.verb?"/".concat(t.verb):"").replace("//","/")}},e={BASE_URL:"https://story-api.dicoding.dev/v1",DEFAULT_LANGUAGE:"en-us",CACHE_NAME:"StoryApp-v1",VAPID_PUBLIC_KEY:"BA0Nt4ZYz6s_T3v7BqL4C-dI8t5KzJ5g-f-g8h9k0l1m2n3o4p5q6r7s8t9u0v1w2x3y4z5"};function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,n){return(e=function(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(){c=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new N(n||[]);return i(a,"_invoke",{value:O(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var L={};f(L,u,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(I([])));k&&k!==n&&o.call(k,u)&&(L=k);var S=x.prototype=b.prototype=Object.create(L);function _(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function n(i,a,c,u){var s=p(t[i],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,u)}))}u(s.arg)}var a;i(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:y,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return w.prototype=x,i(S,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},_(j.prototype),f(j.prototype,s,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),f(S,l,"Generator"),f(S,u,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),s=o.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function u(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){u(i,n,o,a,c,"next",t)}function c(t){u(i,n,o,a,c,"throw",t)}a(void 0)}))}}const l=function(){var t=arguments;return s(c().mark((function r(){var n,o,i,a,u,s,l,f;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:1,o=t.length>1&&void 0!==t[1]?t[1]:20,r.prev=2,i=localStorage.getItem("token"),a="".concat(e.BASE_URL,"/stories?page=").concat(n,"&size=").concat(o),u={},i&&(u.Authorization="Bearer ".concat(i)),r.next=9,fetch(a,{headers:u});case 9:return s=r.sent,r.next=12,s.json();case 12:if(l=r.sent,s.ok){r.next=16;break}throw f=(null==l?void 0:l.message)||"HTTP ".concat(s.status),new Error(f);case 16:return r.abrupt("return",l);case 19:return r.prev=19,r.t0=r.catch(2),console.error("getAllStories error:",r.t0),r.abrupt("return",{error:r.t0.message||"Unknown error",listStory:[]});case 23:case"end":return r.stop()}}),r,null,[[2,19]])})))()},f=function(t,r){return s(c().mark((function n(){var o,i,u;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat(e.BASE_URL,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:t});case 3:return o=n.sent,n.prev=4,n.next=7,o.json();case 7:i=n.sent,n.next=13;break;case 10:n.prev=10,n.t0=n.catch(4),i=null;case 13:if(o.ok){n.next=17;break}if(u="Failed to add story",i)if(i.message)u=i.message;else if(i.error)u="string"==typeof i.error?i.error:JSON.stringify(i.error);else if(i.errors)try{u=Object.entries(i.errors).map((function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,r)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];return"".concat(o,": ").concat(i)})).join("; ")}catch(t){u=JSON.stringify(i.errors)}else u=JSON.stringify(i);else u="HTTP ".concat(o.status);throw new Error(u);case 17:return n.abrupt("return",i);case 20:throw n.prev=20,n.t1=n.catch(0),console.error("Error adding story:",n.t1),n.t1;case 24:case"end":return n.stop()}}),n,null,[[0,20],[4,10]])})))()},h=function(t,r,n){return s(c().mark((function o(){var i,a;return c().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,console.log("Registering user:",r),o.next=4,fetch("".concat(e.BASE_URL,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:r,password:n})});case 4:return i=o.sent,o.next=7,i.json();case 7:if(a=o.sent,i.ok){o.next=10;break}throw new Error(a.message||"Registration failed");case 10:return console.log("Register successful:",a),o.abrupt("return",a);case 14:throw o.prev=14,o.t0=o.catch(0),console.error("Error registering:",o.t0),o.t0;case 18:case"end":return o.stop()}}),o,null,[[0,14]])})))()},p=function(t,r){return s(c().mark((function n(){var o,i;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("Logging in user:",t),n.next=4,fetch("".concat(e.BASE_URL,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})});case 4:return o=n.sent,n.next=7,o.json();case 7:if(i=n.sent,o.ok){n.next=10;break}throw new Error(i.message||"Login failed");case 10:return console.log("Login successful"),n.abrupt("return",i);case 14:throw n.prev=14,n.t0=n.catch(0),console.error("Error logging in:",n.t0),n.t0;case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))()},d=function(t){return s(c().mark((function r(){var n,i,a;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=localStorage.getItem("token"),r.next=4,fetch("".concat(e.BASE_URL,"/subscriptions"),{method:"POST",headers:o({"Content-Type":"application/json"},n?{Authorization:"Bearer ".concat(n)}:{}),body:JSON.stringify(t)});case 4:if((i=r.sent).ok){r.next=10;break}return r.next=8,i.json();case 8:throw a=r.sent,new Error(a.message||"Failed to save subscription");case 10:return console.log("Push subscription saved"),r.next=13,i.json();case 13:return r.abrupt("return",r.sent);case 16:throw r.prev=16,r.t0=r.catch(0),console.error("savePushSubscription error:",r.t0),r.t0;case 20:case"end":return r.stop()}}),r,null,[[0,16]])})))()},y=function(t){return s(c().mark((function r(){var n,i;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=localStorage.getItem("token"),r.next=4,fetch("".concat(e.BASE_URL,"/subscriptions/unsubscribe"),{method:"POST",headers:o({"Content-Type":"application/json"},n?{Authorization:"Bearer ".concat(n)}:{}),body:JSON.stringify({endpoint:t.endpoint})});case 4:return(i=r.sent).ok||console.warn("Unsubscribe response not ok",i.status),console.log("Push unsubscribed"),r.next=9,i.json().catch((function(){return{}}));case 9:return r.abrupt("return",r.sent);case 12:r.prev=12,r.t0=r.catch(0),console.error("unsubscribePush error:",r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))()};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(){m=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function b(){}function w(){}function x(){}var L={};s(L,a,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(I([])));k&&k!==r&&n.call(k,a)&&(L=k);var S=x.prototype=b.prototype=Object.create(L);function _(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=s(x,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},_(j.prototype),s(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function g(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function b(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){g(i,n,o,a,c,"next",t)}function c(t){g(i,n,o,a,c,"throw",t)}a(void 0)}))}}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"story-app-db",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(r,n){var o=indexedDB.open(t,e);o.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains("stories")){var r=e.createObjectStore("stories",{keyPath:"id"});r.createIndex("createdAt","createdAt",{unique:!1}),r.createIndex("name","name",{unique:!1})}e.objectStoreNames.contains("outbox")||e.createObjectStore("outbox",{keyPath:"id",autoIncrement:!0})},o.onsuccess=function(){return r(o.result)},o.onerror=function(){return n(o.error)}}))}function x(t){return E.apply(this,arguments)}function E(){return(E=b(m().mark((function t(e){var r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,n){var o=r.transaction(e,"readonly").objectStore(e).getAll();o.onsuccess=function(){return t(o.result)},o.onerror=function(){return n(o.error)}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(t,e){return S.apply(this,arguments)}function S(){return(S=b(m().mark((function t(e,r){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=n.transaction(e,"readwrite").objectStore(e).put(r);i.onsuccess=function(){return t(i.result)},i.onerror=function(){return o(i.error)}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t,e){return j.apply(this,arguments)}function j(){return(j=b(m().mark((function t(e,r){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=n.transaction(e,"readwrite").objectStore(e).add(r);i.onsuccess=function(){return t(i.result)},i.onerror=function(){return o(i.error)}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,e){return P.apply(this,arguments)}function P(){return(P=b(m().mark((function t(e,r){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=n.transaction(e,"readwrite").objectStore(e).delete(r);i.onsuccess=function(){return t(!0)},i.onerror=function(){return o(i.error)}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(t,e){return T.apply(this,arguments)}function T(){return(T=b(m().mark((function t(e,r){var n,o;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:return t.sent,t.next=5,x(e);case 5:return n=t.sent,o=r.toLowerCase(),t.abrupt("return",n.filter((function(t){return t.name&&t.name.toLowerCase().includes(o)||t.description&&t.description.toLowerCase().includes(o)})));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(t){return I.apply(this,arguments)}function I(){return I=b(m().mark((function t(e){var r,n,o,i=arguments;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:"createdAt",n=i.length>2&&void 0!==i[2]?i[2]:"desc",t.next=4,x(e);case 4:return o=t.sent,t.abrupt("return",o.sort((function(t,e){var o=t[r]||"",i=e[r]||"";return"asc"===n?o>i?1:-1:o<i?1:-1})));case 6:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function C(){C=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==G(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(G(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function F(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=B(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function B(t,e){if(t){if("string"==typeof t)return D(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function z(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function M(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){z(i,n,o,a,c,"next",t)}function c(t){z(i,n,o,a,c,"throw",t)}a(void 0)}))}}const R={currentStories:[],currentFilter:"all",render:function(){var t=this;return M(C().mark((function e(){var r,n,o,i,a,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l(1,30);case 3:if(r=e.sent,n=[],!r||!Array.isArray(r.listStory)){e.next=9;break}n=r.listStory,e.next=31;break;case 9:if(!Array.isArray(r)){e.next=13;break}n=r,e.next=31;break;case 13:if(!r||!r.error){e.next=24;break}if(navigator.onLine){e.next=21;break}return console.log("[Home] Offline - loading from IndexedDB"),e.next=18,x("stories");case 18:n=e.sent,e.next=22;break;case 21:return e.abrupt("return",t._showError(r.error));case 22:e.next=31;break;case 24:if(navigator.onLine){e.next=30;break}return e.next=27,x("stories");case 27:n=e.sent,e.next=31;break;case 30:n=[];case 31:o=F(n),e.prev=32,o.s();case 34:if((i=o.n()).done){e.next=46;break}return a=i.value,e.prev=36,e.next=39,k("stories",a);case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(36),console.warn("[Home] Cache failed:",e.t0);case 44:e.next=34;break;case 46:e.next=51;break;case 48:e.prev=48,e.t1=e.catch(32),o.e(e.t1);case 51:return e.prev=51,o.f(),e.finish(51);case 54:t.currentStories=n,t._displayStories(n),e.next=66;break;case 58:return e.prev=58,e.t2=e.catch(0),console.error("[Home] Render error:",e.t2),e.next=63,x("stories");case 63:c=e.sent,t.currentStories=c,t._displayStories(c);case 66:case"end":return e.stop()}}),e,null,[[0,58],[32,48,51,54],[36,41]])})))()},_displayStories:function(t){var e=this,r=document.getElementById("home-page");r&&r.remove();var n=document.createElement("section");if(n.id="home-page",n.className="home-page",!Array.isArray(t)||0===t.length)return n.innerHTML='\n        <div class="container">\n          <div class="stories-header">\n            <h1>Daftar Cerita</h1>\n            <a href="#/add-story" class="btn-add-story">+ Tambah Cerita</a>\n          </div>\n          <p>Tidak ada cerita tersedia.</p>\n        </div>\n      ',void document.getElementById("main-content").appendChild(n);n.innerHTML='\n      <div class="container">\n        <div class="stories-header">\n          <h1>Daftar Cerita</h1>\n          <a href="#/add-story" class="btn-add-story">+ Tambah Cerita</a>\n        </div>\n\n        <div class="stories-controls" style="margin-bottom: 1.5rem; padding: 1rem; background: #f5f5f5; border-radius: 8px;">\n          <input \n            type="text" \n            id="search-input" \n            placeholder="Cari cerita..." \n            style="width: 100%; padding: 0.5rem; margin-bottom: 0.5rem; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;"\n          />\n          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">\n            <button class="filter-btn" data-filter="all" style="padding: 0.5rem 1rem; background: #3f51b5; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">Semua</button>\n            <button class="filter-btn" data-filter="recent" style="padding: 0.5rem 1rem; background: #ccc; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">Terbaru</button>\n            <button class="filter-btn" data-filter="oldest" style="padding: 0.5rem 1rem; background: #ccc; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">Tertua</button>\n          </div>\n        </div>\n\n        <div class="stories-container">\n          <div id="map" class="map-container" style="height: 400px; margin-bottom: 2rem; border-radius: 8px;"></div>\n          \n          <div id="stories-list" class="stories-list">\n            '.concat(t.map((function(t,e){return'\n              <article class="story-card" data-lat="'.concat(t.lat||"",'" data-lon="').concat(t.lon||"",'" data-idx="').concat(e,'" data-id="').concat(t.id||"",'" style="position: relative; padding-bottom: 3rem; margin-bottom: 1rem;">\n                <img src="').concat(t.photoUrl||"",'" alt="Foto cerita ').concat(t.name||"",'" class="story-image" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 0.5rem;" />\n                <div class="story-content">\n                  <h2 style="margin: 0.5rem 0;">').concat(t.name||"Tanpa Judul",'</h2>\n                  <p class="story-description" style="margin: 0.5rem 0; color: #666;">').concat((t.description||"").substring(0,150),'</p>\n                  <small style="color: #999;">').concat(t.createdAt?new Date(t.createdAt).toLocaleDateString("id-ID"):"",'</small>\n                </div>\n                <button \n                  class="btn-delete-story" \n                  data-story-id="').concat(t.id||"",'" \n                  style="position: absolute; bottom: 0.5rem; right: 0.5rem; padding: 0.35rem 0.75rem; background: #f44336; color: white; border: none; cursor: pointer; border-radius: 4px; font-size: 0.8rem;">\n                  üóëÔ∏è Hapus\n                </button>\n              </article>\n            ')})).join(""),"\n          </div>\n        </div>\n      </div>\n    "),document.getElementById("main-content").appendChild(n),this._attachHandlers(t),t.length>0&&setTimeout((function(){return e._initMap(t)}),100)},_attachHandlers:function(t){var e=this,r=document.getElementById("search-input");r&&r.addEventListener("input",function(){var r=M(C().mark((function r(n){var o,i;return C().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n.target.value.trim()){r.next=5;break}e._displayStories(t),r.next=9;break;case 5:return r.next=7,A("stories",o);case 7:i=r.sent,e._displayStories(i);case 9:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()),document.querySelectorAll(".filter-btn").forEach((function(r){r.addEventListener("click",function(){var n=M(C().mark((function n(o){var i,a;return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.preventDefault(),i=r.dataset.filter,e.currentFilter=i,document.querySelectorAll(".filter-btn").forEach((function(t){t.style.background=t===r?"#3f51b5":"#ccc",t.style.color=t===r?"white":"#000"})),a=function(t){if(Array.isArray(t))return D(t)}(c=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(c)||B(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),"recent"!==i){n.next=11;break}return n.next=8,N("stories","createdAt","desc");case 8:a=n.sent,n.next=15;break;case 11:if("oldest"!==i){n.next=15;break}return n.next=14,N("stories","createdAt","asc");case 14:a=n.sent;case 15:e._displayStories(a);case 16:case"end":return n.stop()}var c}),n)})));return function(t){return n.apply(this,arguments)}}())})),document.querySelectorAll(".btn-delete-story").forEach((function(t){t.addEventListener("click",function(){var e=M(C().mark((function e(r){var n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),r.stopPropagation(),(n=t.dataset.storyId)&&confirm("Hapus cerita ini?")){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,O("stories",n);case 8:t.closest(".story-card").remove(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),console.error("Delete error:",e.t0),alert("Gagal menghapus cerita");case 15:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}())})),document.querySelectorAll(".story-card").forEach((function(t){t.addEventListener("click",(function(e){if(!e.target.closest(".btn-delete-story")){var r=parseFloat(t.dataset.lat),n=parseFloat(t.dataset.lon);if(!Number.isNaN(r)&&!Number.isNaN(n)){var o=window._homePageMap;o&&o.setView([r,n],13,{animate:!0})}}}))}))},_initMap:function(t){if(document.getElementById("map"))try{var e=L.map("map").setView([-6.2088,106.8456],10);window._homePageMap=e;var r=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}),n=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:"&copy; CARTO",maxZoom:19});r.addTo(e),L.control.layers({OpenStreetMap:r,"Carto Light":n}).addTo(e),t.forEach((function(t){t.lat&&t.lon&&L.marker([t.lat,t.lon]).addTo(e).bindPopup('\n            <div>\n              <img src="'.concat(t.photoUrl||"",'" alt="" style="width: 100%; max-height: 150px; border-radius: 4px;" />\n              <h4 style="margin: 0.5rem 0;">').concat(t.name||"",'</h4>\n              <p style="margin: 0; font-size: 0.9rem;">').concat((t.description||"").substring(0,80),"</p>\n            </div>\n          "))}))}catch(t){console.error("[Home] Map error:",t)}},_showError:function(t){var e=document.createElement("section");e.id="home-page",e.innerHTML='<div class="container" style="padding: 2rem; text-align: center; color: #d32f2f;"><p>'.concat(t,"</p></div>"),document.getElementById("main-content").appendChild(e)},elementId:"#home-page"};function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function q(){q=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==U(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(U(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function H(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}const Y={render:function(){return(t=q().mark((function t(){var e;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.createElement("section")).id="about-page",e.className="about-page",e.innerHTML='\n      <div class="container" style="max-width: 800px; margin: 2rem auto; padding: 0 1rem;">\n        <h1>Tentang Story App</h1>\n        <p>Story App adalah aplikasi web progresif yang memungkinkan Anda berbagi cerita dengan lokasi pada peta interaktif.</p>\n        \n        <h2>Fitur Utama</h2>\n        <ul style="line-height: 1.8;">\n          <li>üìç Bagikan cerita dengan lokasi pada peta</li>\n          <li>üîî Terima notifikasi untuk cerita baru</li>\n          <li>üì± Instal aplikasi di homescreen</li>\n          <li>üîì Akses offline untuk data yang sudah disimpan</li>\n          <li>üîç Cari dan filter cerita</li>\n        </ul>\n\n        <h2>Teknologi</h2>\n        <p>Dibangun dengan:</p>\n        <ul style="line-height: 1.8;">\n          <li>HTML5, CSS3, JavaScript ES6+</li>\n          <li>Service Worker untuk offline support</li>\n          <li>IndexedDB untuk penyimpanan lokal</li>\n          <li>Leaflet.js untuk peta interaktif</li>\n          <li>Push Notifications API</li>\n        </ul>\n\n        <h2>Privacy & Security</h2>\n        <p>Data Anda disimpan secara aman dengan enkripsi. Kami menghormati privasi Anda dan tidak membagikan data tanpa persetujuan.</p>\n\n        <p style="margin-top: 2rem; text-align: center; color: #666;">\n          <small>Story App v1.0 &copy; 2024 | <a href="#/" style="color: #3f51b5; text-decoration: none;">Kembali ke Home</a></small>\n        </p>\n      </div>\n    ',document.getElementById("main-content").appendChild(e);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){H(i,n,o,a,c,"next",t)}function c(t){H(i,n,o,a,c,"throw",t)}a(void 0)}))})();var t},elementId:"#about-page"};function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function J(){J=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==W(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(W(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function V(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function K(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){V(i,n,o,a,c,"next",t)}function c(t){V(i,n,o,a,c,"throw",t)}a(void 0)}))}}const Z={map:null,selectedLat:null,selectedLon:null,marker:null,_compressImageFile:function(t){var e=arguments;return K(J().mark((function r(){var n,o,i,a,c,u,s,l,f;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.length>1&&void 0!==e[1]?e[1]:9e5,t&&t.type.startsWith("image/")){r.next=3;break}return r.abrupt("return",t);case 3:return r.next=5,new Promise((function(e,r){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=r,n.readAsDataURL(t)}));case 5:return o=r.sent,r.next=8,new Promise((function(t,e){var r=new Image;r.onload=function(){return t(r)},r.onerror=e,r.src=o}));case 8:return i=r.sent,a=document.createElement("canvas"),c=1280,u=i.width,s=i.height,u>c&&(s=Math.round(c/u*s),u=c),a.width=u,a.height=s,a.getContext("2d").drawImage(i,0,0,u,s),l=.9,r.next=20,new Promise((function(t){return a.toBlob(t,"image/jpeg",l)}));case 20:f=r.sent;case 21:if(!(f&&f.size>n&&l>.2)){r.next=28;break}return l-=.1,r.next=25,new Promise((function(t){return a.toBlob(t,"image/jpeg",Math.max(.1,l))}));case 25:f=r.sent,r.next=21;break;case 28:if(f){r.next=30;break}return r.abrupt("return",t);case 30:return r.prev=30,r.abrupt("return",new File([f],t.name.replace(/\.\w+$/,".jpg"),{type:"image/jpeg"}));case 34:return r.prev=34,r.t0=r.catch(30),r.abrupt("return",f);case 37:case"end":return r.stop()}}),r,null,[[30,34]])})))()},render:function(){var t=this;return K(J().mark((function e(){var r;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(r=document.createElement("section")).id="add-story-page",r.className="add-story-page",r.innerHTML='\n        <div class="container">\n          <h1>Tambah Cerita Baru</h1>\n          <form id="add-story-form">\n            <div class="form-group">\n              <label for="name">Judul Cerita</label>\n              <input type="text" id="name" name="name" placeholder="Judul cerita Anda" required />\n            </div>\n            <div class="form-group">\n              <label for="description">Deskripsi</label>\n              <textarea id="description" name="description" placeholder="Cerita Anda di sini..." rows="5" required></textarea>\n            </div>\n            <div class="form-group">\n              <label for="photo">Foto Cerita</label>\n              <input type="file" id="photo" name="photo" accept="image/*" required />\n            </div>\n            <div class="form-group">\n              <p style="font-size: 0.9rem; color: #666;">Klik pada peta untuk memilih lokasi</p>\n              <div id="map" class="map-container" style="height: 300px; margin-bottom: 1rem; border-radius: 8px; border: 1px solid #ddd;"></div>\n            </div>\n            <button type="submit" class="btn-primary">Tambah Cerita</button>\n          </form>\n          <div id="error-message" class="error-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #ffebee; color: #c62828; border-radius: 4px;"></div>\n          <div id="success-message" class="success-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9; color: #2e7d32; border-radius: 4px;"></div>\n        </div>\n      ',document.getElementById("main-content").appendChild(r),t._initMap(),t._attachFormListener()}catch(t){console.error("AddStoryPage render error",t)}case 1:case"end":return e.stop()}}),e)})))()},_initMap:function(){var t=this;try{this.map=L.map("map").setView([-6.2088,106.8456],10),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap contributors",maxZoom:19}).addTo(this.map),this.map.on("click",(function(e){t.selectedLat=e.latlng.lat,t.selectedLon=e.latlng.lng,t.marker&&t.map.removeLayer(t.marker),t.marker=L.marker([t.selectedLat,t.selectedLon]).addTo(t.map),t.marker.bindPopup("<div><p>Lat: ".concat(t.selectedLat.toFixed(4),"</p><p>Lon: ").concat(t.selectedLon.toFixed(4),"</p></div>")).openPopup()}))}catch(t){console.error("Map init error",t)}},_attachFormListener:function(){var t=this;return K(J().mark((function r(){return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:document.getElementById("add-story-form").addEventListener("submit",function(){var r=K(J().mark((function r(n){var o,i,a,c,u,s,l,h,p,d,y;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=localStorage.getItem("token")){r.next=5;break}return window.location.hash="#/login",r.abrupt("return");case 5:if(i=document.getElementById("error-message"),a=document.getElementById("success-message"),i.style.display="none",a.style.display="none",c=document.getElementById("name").value.trim(),(u=document.getElementById("description").value.trim())&&!(u.length<10)){r.next=15;break}return i.style.display="block",i.textContent="‚úó Deskripsi terlalu pendek (minimal 10 karakter).",r.abrupt("return");case 15:if(t.selectedLat&&t.selectedLon){r.next=19;break}return i.style.display="block",i.textContent="‚úó Pilih lokasi di peta terlebih dahulu.",r.abrupt("return");case 19:if(s=document.getElementById("photo"),(l=s.files[0])&&l.type.startsWith("image/")){r.next=25;break}return i.style.display="block",i.textContent="‚úó Pilih file gambar yang valid.",r.abrupt("return");case 25:if(h=c?"".concat(c,"\n\n").concat(u):u,p=l,r.prev=27,!(l.size>95e4)){r.next=32;break}return r.next=31,t._compressImageFile(l,9e5);case 31:p=r.sent;case 32:r.next=38;break;case 34:r.prev=34,r.t0=r.catch(27),console.warn("Compression failed",r.t0),p=l;case 38:if(!(p.size&&p.size>1e6)){r.next=42;break}return i.style.display="block",i.textContent="‚úó Gambar terlalu besar. Gunakan gambar < 1MB.",r.abrupt("return");case 42:return(d=new FormData).append("description",h),d.append("photo",p,p.name||"photo.jpg"),d.append("lat",t.selectedLat),d.append("lon",t.selectedLon),r.prev=47,r.next=50,f(d,o);case 50:a.style.display="block",a.textContent="‚úì Cerita berhasil ditambahkan!",setTimeout((function(){window.location.hash="#/"}),1500),r.next=59;break;case 55:if(r.prev=55,r.t1=r.catch(47),console.warn("[AddStory] Network send failed, saving to outbox",r.t1),navigator.onLine)i.style.display="block",i.textContent="‚úó Error: ".concat(r.t1.message||"Terjadi kesalahan");else try{(y=new FileReader).onload=K(J().mark((function r(){var n,i;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=y.result,r.next=3,_("outbox",{description:h,imageDataUrl:n,lat:t.selectedLat,lon:t.selectedLon,token:o,apiUrl:e.BASE_URL,createdAt:(new Date).toISOString()});case 3:if(!("serviceWorker"in navigator)||!("SyncManager"in window)){r.next=15;break}return r.prev=4,r.next=7,navigator.serviceWorker.ready;case 7:return i=r.sent,r.next=10,i.sync.register("sync-outbox");case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),console.warn("[AddStory] Sync register failed",r.t0);case 15:a.style.display="block",a.textContent="‚úì Cerita disimpan offline dan akan dikirim saat online.",setTimeout((function(){window.location.hash="#/"}),1500);case 18:case"end":return r.stop()}}),r,null,[[4,12]])}))),y.readAsDataURL(p)}catch(t){console.error("[AddStory] IndexedDB save failed",t),i.style.display="block",i.textContent="‚úó Gagal menyimpan cerita: ".concat(t.message)}case 59:case"end":return r.stop()}}),r,null,[[27,34],[47,55]])})));return function(t){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},elementId:"#add-story-page"};var $=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SA";return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '.concat(t," ").concat(t,'">\n    <rect fill="#3f51b5" width="').concat(t,'" height="').concat(t,'"/>\n    <text x="50%" y="50%" font-size="').concat(.4*t,'" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="central">\n      ').concat(e,"\n    </text>\n  </svg>")},Q=$(96,"SA"),X=$(192,"SA"),tt=$(512,"SA");function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function rt(){rt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==et(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(et(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function nt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function ot(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){nt(i,n,o,a,c,"next",t)}function c(t){nt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function at(){at=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==it(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(it(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ct(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ct(i,n,o,a,c,"next",t)}function c(t){ct(i,n,o,a,c,"throw",t)}a(void 0)}))}}console.log("96:",Q),console.log("192:",X),console.log("512:",tt);const st={"/":R,"/about":Y,"/add-story":Z,"/login":{render:function(){return ot(rt().mark((function t(){var e;return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.createElement("section")).id="login-page",e.className="login-page",e.innerHTML='\n      <div class="auth-container" style="max-width: 500px; margin: 3rem auto; padding: 0 1rem;">\n        <div class="auth-card" style="padding: 2rem; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n          <h1 style="text-align: center; margin-bottom: 2rem;">Login</h1>\n          <form id="login-form">\n            <div class="form-group" style="margin-bottom: 1rem;">\n              <label for="email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Email</label>\n              <input type="email" id="email" name="email" placeholder="contoh@email.com" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1rem;" />\n            </div>\n            <div class="form-group" style="margin-bottom: 1.5rem;">\n              <label for="password" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Password</label>\n              <input type="password" id="password" name="password" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1rem;" />\n            </div>\n            <button type="submit" class="btn-primary" style="width: 100%; padding: 0.75rem; background: #3f51b5; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: 500;">Login</button>\n            <p style="text-align: center; margin-top: 1rem;">Belum punya akun? <a href="#/register" style="color: #3f51b5; text-decoration: none;">Daftar di sini</a></p>\n          </form>\n          <div id="error-message" class="error-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #ffebee; color: #c62828; border-radius: 4px; text-align: center;"></div>\n          <div id="success-message" class="success-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9; color: #2e7d32; border-radius: 4px; text-align: center;"></div>\n        </div>\n      </div>\n    ',document.getElementById("main-content").appendChild(e),document.getElementById("login-form").addEventListener("submit",function(){var t=ot(rt().mark((function t(e){var r,n,o,i,a;return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=document.getElementById("email").value,n=document.getElementById("password").value,o=document.getElementById("error-message"),i=document.getElementById("success-message"),o.style.display="none",i.style.display="none",t.prev=7,t.next=10,p(r,n);case 10:if(!(a=t.sent).loginResult||!a.loginResult.token){t.next=20;break}localStorage.setItem("token",a.loginResult.token),localStorage.setItem("userId",a.loginResult.userId),"function"==typeof window.updateAuthNav&&window.updateAuthNav(),i.style.display="block",i.textContent="‚úì Login berhasil! Redirect...",setTimeout((function(){window.location.hash="#/"}),1e3),t.next=21;break;case 20:throw new Error("Response tidak valid");case 21:t.next=28;break;case 23:t.prev=23,t.t0=t.catch(7),console.error("Login error:",t.t0),o.style.display="block",o.textContent="‚úó ".concat(t.t0.message);case 28:case"end":return t.stop()}}),t,null,[[7,23]])})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t)})))()},elementId:"#login-page"},"/register":{render:function(){return ut(at().mark((function t(){var e;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.createElement("section")).id="register-page",e.className="register-page",e.innerHTML='\n      <div class="auth-container" style="max-width: 500px; margin: 3rem auto; padding: 0 1rem;">\n        <div class="auth-card" style="padding: 2rem; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n          <h1 style="text-align: center; margin-bottom: 2rem;">Daftar Akun</h1>\n          <form id="register-form">\n            <div class="form-group" style="margin-bottom: 1rem;">\n              <label for="name" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Nama</label>\n              <input type="text" id="name" name="name" placeholder="Nama lengkap" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1rem;" />\n            </div>\n            <div class="form-group" style="margin-bottom: 1rem;">\n              <label for="email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Email</label>\n              <input type="email" id="email" name="email" placeholder="contoh@email.com" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1rem;" />\n            </div>\n            <div class="form-group" style="margin-bottom: 1.5rem;">\n              <label for="password" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Password</label>\n              <input type="password" id="password" name="password" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1rem;" />\n            </div>\n            <button type="submit" class="btn-primary" style="width: 100%; padding: 0.75rem; background: #3f51b5; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: 500;">Daftar</button>\n            <p style="text-align: center; margin-top: 1rem;">Sudah punya akun? <a href="#/login" style="color: #3f51b5; text-decoration: none;">Login di sini</a></p>\n          </form>\n          <div id="error-message" class="error-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #ffebee; color: #c62828; border-radius: 4px; text-align: center;"></div>\n          <div id="success-message" class="success-message" style="display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9; color: #2e7d32; border-radius: 4px; text-align: center;"></div>\n        </div>\n      </div>\n    ',document.getElementById("main-content").appendChild(e),document.getElementById("register-form").addEventListener("submit",function(){var t=ut(at().mark((function t(e){var r,n,o,i,a;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=document.getElementById("name").value,n=document.getElementById("email").value,o=document.getElementById("password").value,i=document.getElementById("error-message"),a=document.getElementById("success-message"),i.style.display="none",a.style.display="none",t.prev=8,t.next=11,h(r,n,o);case 11:t.sent,a.style.display="block",a.textContent="‚úì Pendaftaran berhasil! Arahkan ke login...",setTimeout((function(){window.location.hash="#/login"}),1500),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(8),console.error("Register error:",t.t0),i.style.display="block",i.textContent="‚úó ".concat(t.t0.message);case 22:case"end":return t.stop()}}),t,null,[[8,17]])})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t)})))()},elementId:"#register-page"}};function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ft(){ft=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==lt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(lt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ht(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ht(i,n,o,a,c,"next",t)}function c(t){ht(i,n,o,a,c,"throw",t)}a(void 0)}))}}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t){if("object"!=lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lt(e)?e:e+""}const vt=function(){return e=function t(e){var r=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._content=r,this._initialAppShell()},r=[{key:"_initialAppShell",value:function(){var t=this;this._route(),window.addEventListener("hashchange",(function(){return t._route()}))}},{key:"_route",value:(o=pt(ft().mark((function e(){var r,n,o,i=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.parseActiveUrlWithCombiner(),n=st[r]||st["/"],o=function(){var t=pt(ft().mark((function t(){var e;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i._content.innerHTML="",i._content.style.opacity="0",i._content.style.transition="opacity 0.25s ease-in-out",t.next=5,n.render();case 5:(e=document.querySelector(n.elementId))&&!i._content.contains(e)&&i._content.appendChild(e),requestAnimationFrame((function(){i._content.style.opacity="1"}));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.prev=3,!("startViewTransition"in document)){e.next=9;break}return e.next=7,document.startViewTransition(o);case 7:e.next=11;break;case 9:return e.next=11,o();case 11:e.next=18;break;case 13:e.prev=13,e.t0=e.catch(3),console.error("[App] Route error:",e.t0),this._content.innerHTML='<div style="padding: 1rem; color: red;">Error: '.concat(e.t0.message,"</div>"),this._content.style.opacity="1";case 18:case"end":return e.stop()}}),e,this,[[3,13]])}))),function(){return o.apply(this,arguments)})},{key:"renderCurrentRoute",value:(n=pt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._route());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],r&&dt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function gt(){gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==mt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?y:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(mt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),s(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),s(E,u,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function bt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function wt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bt(i,n,o,a,c,"next",t)}function c(t){bt(i,n,o,a,c,"throw",t)}a(void 0)}))}}window.CONFIG=e;var xt=new vt({content:document.getElementById("main-content")}),Lt=document.querySelector(".skip-to-content");function Et(){var t=localStorage.getItem("token");document.querySelectorAll(".nav-list a").forEach((function(e){var r=(e.getAttribute("href")||"").trim();("#/login"===r||r.endsWith("/login"))&&(t?(e.textContent="Logout",e.dataset.auth="logout",e.setAttribute("href","#/")):(e.textContent="Login",delete e.dataset.auth,e.setAttribute("href","#/login")))}));var e="serviceWorker"in navigator&&"PushManager"in window;document.querySelectorAll("#push-toggle, #push-toggle-drawer").forEach((function(t){t.style.display=e?"inline-block":"none",e&&function(t){kt.apply(this,arguments)}(t)}))}function kt(){return(kt=wt(gt().mark((function t(e){var r;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return r=t.sent,t.next=6,r.pushManager.getSubscription();case 6:t.sent?(e.textContent="üîî Disable Notifications",e.dataset.enabled="1"):(e.textContent="üîî Enable Notifications",e.dataset.enabled="0"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.warn("checkPushSubscriptionState error",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function St(t){return _t.apply(this,arguments)}function _t(){return(_t=wt(gt().mark((function t(r){var n,o,i,a;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return n=t.sent,t.next=6,n.pushManager.getSubscription();case 6:if(!(o=t.sent)||"1"!==r.dataset.enabled){t.next=24;break}return t.next=10,o.unsubscribe();case 10:return t.prev=10,t.next=13,y(o);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(10),console.warn("Backend unsubscribe failed",t.t0);case 18:r.textContent="üîî Enable Notifications",r.dataset.enabled="0",Et(),alert("Notifikasi dimatikan"),t.next=42;break;case 24:if(i=e.VAPID_PUBLIC_KEY){t.next=27;break}return t.abrupt("return",alert("VAPID public key not configured"));case 27:return t.next=29,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jt(i)});case 29:return a=t.sent,t.prev=30,t.next=33,d(a);case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(30),console.error("Backend subscribe failed",t.t1);case 38:r.textContent="üîî Disable Notifications",r.dataset.enabled="1",Et(),alert("Notifikasi diaktifkan - Anda akan menerima pemberitahuan cerita baru");case 42:t.next=48;break;case 44:t.prev=44,t.t2=t.catch(0),console.error("Push toggle error",t.t2),alert("Error: "+t.t2.message);case 48:case"end":return t.stop()}}),t,null,[[0,44],[10,15],[30,35]])})))).apply(this,arguments)}function jt(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}Lt&&Lt.addEventListener("click",(function(t){t.preventDefault();var e=document.getElementById("main-content");e&&(e.tabIndex=-1,e.focus())})),document.addEventListener("click",function(){var t=wt(gt().mark((function t(e){var r,n;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.target.closest('[data-auth="logout"]')){t.next=13;break}if(e.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("userId"),Et(),window.location.hash="#/","function"!=typeof xt.renderCurrentRoute){t.next=10;break}return t.next=10,xt.renderCurrentRoute();case 10:return(r=document.getElementById("navigation-drawer"))&&r.classList.remove("active"),t.abrupt("return");case 13:if(!(n=e.target.closest("#push-toggle, #push-toggle-drawer"))){t.next=21;break}if(e.preventDefault(),"serviceWorker"in navigator&&"PushManager"in window){t.next=18;break}return t.abrupt("return",alert("Push notifications not supported in this browser"));case 18:return t.next=20,St(n);case 20:return t.abrupt("return");case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),window.updateAuthNav=Et,"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then((function(t){console.log("[App] Service Worker registered:",t)})).catch((function(t){console.error("[App] Service Worker registration failed:",t)})),Et();var Ot=document.getElementById("drawer-button"),Pt=document.getElementById("navigation-drawer");Ot&&Pt&&(Ot.addEventListener("click",(function(){Pt.classList.toggle("active")})),document.querySelectorAll(".nav-list a").forEach((function(t){t.addEventListener("click",(function(){Pt.classList.remove("active")}))})))})();